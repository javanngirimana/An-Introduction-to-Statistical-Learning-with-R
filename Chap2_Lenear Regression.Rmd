---
title: "Lenear Regression"
author: "Javan"
date: "2026-01-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# Statistical Learning
#2.3.1 Basic Commands
# R uses functions to perform operations
# In the following formulas, you can use (= or <-) signs

x <- c(1, 3, 2, 5)
x
```
```{r}
x= c(1, 6, 2)
x
y= c(1, 4, 3)
y
```


# length
```{r}
x= c(1, 6, 2)
y= c(1, 4, 3)
length(x)
length(y)
x+y
```

# We use (ls) to display all functions used before
# we use (rm) to delete unwanted functions
```{r}
ls()

rm()
```

# It’s also possible to remove all objects at once:
```{r}
rm(list = ls())
```



```{r}
ls()
```

# Matrix
# Option 1 of designing matrix
```{r}
x <- matrix(data = c(1, 2, 3, 4), nrow = 2, ncol = 2)
x
```
# Option 2 of designing matrix
```{r}
x <- matrix(c(1, 2, 3, 4), 2, 2)
x
```


# Option 3 of designing matrix (byrow = TRUE)
```{r}
matrix(c(1, 2, 3, 4), 2, 2, byrow = TRUE)
```

# The sqrt() function returns the square root of each sqrt() element of a vector or matrix.
```{r}
sqrt(x)
```

# The command x^2 raises each element of x to the power 2
```{r}
x^2
```


# The rnorm() function generates a vector of random normal variables, rnorm() with first argument n the sample size. 

```{r}
x <- rnorm(50)
y <- x + rnorm(50, mean = 50, sd = .1)
cor(x, y)
```


# we can use the (set.seed()) to reproduce the exact same set of random numbers
```{r}
set.seed(1303)
rnorm(50)
```


# The mean() and var() functions can be used to compute the mean and mean() var() variance of a vector of numbers.

```{r}
set.seed(3)
y <- rnorm(100)
mean(y)
var(y)
sqrt(var(y))
sd(y)
```

# Graphics
# Statistical Learning

```{r}
x <- rnorm(100)
y <- rnorm(100)
plot(x, y)
plot(x, y, xlab = "this is the x-axis",
ylab = "this is the y-axis",
main = "Plot of X vs Y")
```


# to create a pdf, we use the pdf() function, and to create a jpeg, pdf() we use the jpeg() function.

```{r}
pdf("Figure.pdf")
plot(x, y, col = "green")
dev.off()
```

# integer arguments.

```{r}
x <- seq(1, 10)
x
x <- 1:10
x
x <- seq(-pi, pi, length = 50)
```
# output of the contour() function
```{r}
y <- x
f <- outer(x, y, function(x, y) cos(y) / (1 + x^2))
contour(x, y, f)
contour(x, y, f, nlevels = 45, add = T)
fa <- (f - t(f)) / 2
contour(x, y, fa, nlevels = 15)
```


# Persp() can be used to produce a three-dimensional persp() plot

```{r}
image(x, y, fa)
persp(x, y, fa)
persp(x, y, fa, theta = 30)
persp(x, y, fa, theta = 30, phi = 20)
persp(x, y, fa, theta = 30, phi = 70)
persp(x, y, fa, theta = 30, phi = 40)
```


# 2.3.3 Indexing Data
# Suppose that our data is stored in the matrix A.

```{r}
A <- matrix(1:16, 4, 4)
A
```

#Then, typing
```{r}
A[2, 3]
```


# We can also select multiple rows and columns at a time, by providing vectors as the indices

```{r}
A[c(1, 3), c(2, 4)]
A[1:3, 2:4]
A[1:2, ]
```



# 2. Statistical Learning

```{r}
A[, 1:2]
```


# R treats a single row or column of a matrix as a vector.
```{r}
 A[1, ]
```


# The use of a negative sign
```{r}
A[-c(1, 3), ]
A[-c(1, 3), -c(1, 3, 4)]
```



# The dim() function outputs the number of rows followed by the number of columns of a given matrix.
```{r}
dim(A)
```

# 2.3.4 Loading Data

# Once the data has been loaded, the View() function can be used to view it in a spreadsheet-like window.
# The head() function can also be used to view the first few rows of the data.

```{r}
setwd("C:/Users/Javis/Documents/AUCA/DATA MINING WORKS")
```

```{r}
getwd()

```
# To check the files in directory
```{r}
list.files()
```




```{r}
Auto <- read.csv("Auto.csv")
View(Auto)
head(Auto)

```


```{r}
Auto <- read.csv("Auto.csv", header = T, na.strings = "?",
stringsAsFactors = T)
View(Auto)
```


# An easy way to load data from Excel into R is to save it as a csv (comma-separated values) file, and then use the read.csv() function.
```{r}
Auto <- read.csv("Auto.csv", na.strings = "?", stringsAsFactors = TRUE)

```

```{r}
Auto <- read.csv(
  "C:/Users/Javis/Documents/AUCA/DATA MINING WORKS/Auto.csv",
  na.strings = "?",
  stringsAsFactors = TRUE)
list.files()

```


# The dim() function tells us that the data has 397 observations, or rows, and dim() nine variables, or columns.

```{r}
View(Auto)
dim(Auto)
```



# only five of the rows contain missing observations, and
# so we choose to use the na.omit() function to simply remove these rows. 

```{r}
Auto <- na.omit(Auto)
dim(Auto)
```

# Once the data are loaded correctly, we can use names() to check the names() variable names.

```{r}
names(Auto)
```

#2.3.5 Additional Graphical and Numerical Summaries

# We can use the plot() function to produce scatterplots of the quantitative scatterplot variables


## Error in plot(cylinders, mpg) : object `cylinders' not found


```{r}
plot(cylinders, mpg)
```




# To refer to a variable, we must type the data set and the variable name joined with a $ symbol. Alternatively, we can use the attach() function in attach() order to tell R to make the variables in this data frame available by name

```{r}
plot(Auto$cylinders, Auto$mpg)
attach(Auto)
plot(cylinders, mpg)
```


# The as.factor() function converts quantitative variables into qualitative as.factor() variables.

```{r}
cylinders <- as.factor(cylinders)
```

# As usual, a number of options can be specified in order to customize the plots.

```{r}
plot(cylinders, mpg)
plot(cylinders , mpg, col = "red")
plot(cylinders , mpg, col = "red", varwidth = T)
plot(cylinders , mpg, col = "red", varwidth = T,
horizontal = T)
plot(cylinders , mpg, col = "red", varwidth = T,
xlab = "cylinders", ylab = "MPG")
```

# The hist() function can be used to plot a histogram. Note that col = 2 hist() histogram has the same effect as col = "red".

```{r}
hist(mpg)
hist(mpg, col = 2)
hist(mpg, col = 2, breaks = 15)
```




# The pairs() function creates a scatterplot matrix
```{r}
pairs(Auto)
pairs( 
  ∼ mpg + displacement + horsepower + weight + acceleration,
data = Auto
)
```
# The numbers printed under the identify() function correspond to the rows for the selected points.
```{r}
plot(horsepower, mpg)
identify(horsepower , mpg, name)
```

# The summary() function produces a numerical summary of each variable in a particular data set.
```{r}
 summary(Auto)
```

# For qualitative variables such as name, R will list the number of observations that fall in each category. We can also produce a summary of just a single variable.
```{r}
summary(mpg)
```

# Applied
# 8. This exercise relates to the College data set, which can be found in the file College.csv on the book website.

# Read dataset
```{r}
College <- read.csv("College.csv")
```


# Print and view dataset
```{r}
head(College)
View(College)
```


# R has given each row a name corresponding to the appropriate university.
```{r}
rownames(College) <- College[, 1]
View(College)
```



# Now you should see that the first data column is Private. 
# Note that another column labeled row.names now appears before the Private column.
```{r}
College <- College[, -1]
View(College)
```

# i Use the summary() function to produce a numerical summary of the variables in the data set.
```{r}
summary(College)
```

# ii Use the pairs() function to produce a scatterplot matrix of the first ten columns or variables of the data. 

```{r}
pairs(College[, 2:10])
```
# iii Use the plot() function to produce side-by-side boxplots of Outstate versus Private.

# Check Private

```{r}
str(College$Private)

```


```{r}
str(College$Outstate)

```
# Fix it properly
```{r}
College$Private <- as.factor(College$Private)

```

# Remove any rows with missing values
```{r}
College <- College[complete.cases(College[, c("Outstate", "Private")]), ]

```


# Plot
```{r}
plot(Outstate ~ Private, data = College,
     xlab = "Private",
     ylab = "Out-of-State Tuition",
     main = "Out-of-State Tuition by College Type")
```

# iv. Create a new qualitative variable, called Elite, by binning the Top10perc variable.

# Step 1: Create the Elite variable
```{r}
Elite <- rep("No", nrow(College))
Elite[College$Top10perc > 50] <- "Yes"
Elite <- as.factor(Elite)
college <- data.frame(College, Elite)
```

# Step 2: Use summary() to see how many elite universities there are
```{r}
summary(College$Elite)

```

# Step 3: Side-by-side boxplots of Outstate vs Elite
```{r}
plot(Outstate ~ Elite, data = College,
     xlab = "Elite Status",
     ylab = "Out-of-State Tuition",
     main = "Out-of-State Tuition by Elite Status")
```
# v. Use the hist() function to produce some histograms with differing numbers of bins for a few of the quantitative variables.

# Histograms with different numbers of bins
```{r}
par(mfrow = c(2, 2))

```

# Make histograms for quantitative variables, changing the number of bins.

```{r}
hist(College$Outstate, breaks = 10,
     main = "Out-of-State Tuition",
     xlab = "Outstate")

hist(College$Enroll, breaks = 20,
     main = "Enrollment",
     xlab = "Enroll")

hist(College$Top10perc, breaks = 15,
     main = "Top 10% Students",
     xlab = "Top10perc")

hist(College$Room.Board, breaks = 10,
     main = "Room and Board Costs",
     xlab = "Room.Board")

```
# vi. Brief summary of discoveries

The data show substantial variability among U.S. colleges. Out-of-state tuition and expenses are higher for private and elite schools. Enrollment is heavily right-skewed, with only a few very large universities. Overall, elite institutions appear to invest more resources per student.

# This exercise involves the Auto data set studied in the lab. Make sure that the missing values have been removed from the data.

# (a) Quantitative vs qualitative predictors
# Check the structure

```{r}
str(Auto)

```



# (b) Range of each quantitative predictor
```{r}
sapply(Auto[, c("mpg", "cylinders", "displacement", "horsepower",
                "weight", "acceleration", "year")], range)

```

# (c) Mean and standard deviation of each quantitative predictor
```{r}
sapply(Auto[, c("mpg", "cylinders", "displacement", "horsepower",
                "weight", "acceleration", "year")], mean)

sapply(Auto[, c("mpg", "cylinders", "displacement", "horsepower",
                "weight", "acceleration", "year")], sd)

```

# (d) Remove observations 10 through 85
# Create the reduced dataset
```{r}
Auto_sub <- Auto[-c(10:85), ]

```

# Range
```{r}
sapply(Auto_sub[, c("mpg", "cylinders", "displacement", "horsepower",
                    "weight", "acceleration", "year")], range)

```

# Mean
```{r}
sapply(Auto_sub[, c("mpg", "cylinders", "displacement", "horsepower",
                    "weight", "acceleration", "year")], mean)

```
# Standard deviation
```{r}
sapply(Auto_sub[, c("mpg", "cylinders", "displacement", "horsepower",
                    "weight", "acceleration", "year")], sd)

```
# (e) Graphical investigation of predictors
# Scatterplot matrix (best overall view)
```{r}
pairs(Auto[, c("mpg", "cylinders", "displacement",
               "horsepower", "weight", "acceleration", "year")])

```

```{r}
plot(Auto$weight, Auto$mpg)
plot(Auto$horsepower, Auto$mpg)
plot(Auto$displacement, Auto$mpg)
plot(Auto$year, Auto$mpg)

```

From the scatterplots, mpg has a strong negative relationship with weight, horsepower, and displacement. As these variables increase, fuel efficiency decreases. There is a positive relationship between mpg and model year, indicating that newer cars tend to have higher gas mileage. Cylinders is also negatively associated with mpg, as cars with more cylinders tend to be less fuel efficient.

# (f) Predicting mpg — which variables are useful?
Yes, several predictors appear useful for predicting mpg. Weight, horsepower, displacement, and cylinders show strong negative relationships with mpg, while year shows a positive relationship. These patterns suggest that heavier, more powerful, and older cars tend to have lower fuel efficiency, making these variables strong candidates for predicting mpg.


# 10. This exercise involves the Boston housing data set.

# (a) To begin, load in the Boston data set. The Boston data set is part of the ISLR2 library.

```{r}
# install.packages("ISLR2")

```
# Load the data & understand its structure
```{r}
library(ISLR2)
data(Boston)

dim(Boston)

```

```{r}
?Boston
```

# (b) Pairwise scatterplots of predictors
```{r}
pairs(Boston)

```
The scatterplot matrix shows several strong relationships among predictors. For example, the number of rooms (rm) is positively associated with median home value (medv), while crime rate (crim) is negatively associated with median home value. Some predictors such as tax rate (tax) and pupil-teacher ratio (ptratio) also show clear patterns with other variables.

# (c) Predictors associated with per capita crime rate
```{r}
pairs(Boston[, c("crim", "zn", "indus", "nox", "rm", "tax", "ptratio", "lstat", "medv")])

```
Answer

Crime rate (crim) is positively associated with industrial land use (indus), nitrogen oxides concentration (nox), tax rate (tax), pupil-teacher ratio (ptratio), and lower status of the population (lstat). It is negatively associated with the number of rooms per dwelling (rm) and median home value (medv). This suggests that poorer, more industrialized areas tend to have higher crime rates.

# (d) High crime, tax, and pupil-teacher ratios + ranges
# Ranges of key predictors
```{r}
range(Boston$crim)
range(Boston$tax)
range(Boston$ptratio)

```

Answer

Some census tracts have extremely high crime rates compared to the rest, indicating the presence of outliers. Tax rates and pupil-teacher ratios also vary substantially across tracts, with some areas having notably higher values. Overall, the wide ranges suggest considerable socioeconomic and environmental diversity among Boston neighborhoods.

# (e) Census tracts bounding the Charles River
```{r}
table(Boston$chas)

```

# (f) Median pupil-teacher ratio
```{r}
median(Boston$ptratio)

```
Answer

The median pupil-teacher ratio is 19.05.

# (g) Census tract with lowest median home value
```{r}
which.min(Boston$medv)

```
```{r}
Boston[which.min(Boston$medv), ]

```


Answer

The census tract with the lowest median value of owner-occupied homes has a median value of $5,000. This tract has very high crime rates, high tax rates, a high pupil-teacher ratio, and a high proportion of lower-status residents. Compared to the overall ranges of the predictors, this tract appears to be an extreme case, reflecting severe socioeconomic disadvantage.

# (h) Census tracts with many rooms per dwelling
```{r}
sum(Boston$rm > 7)
sum(Boston$rm > 8)

```

Answer

More than 7 rooms: 64 tracts

More than 8 rooms: 13 tracts
```{r}
Boston[Boston$rm > 8, ]

```



Comment

Census tracts with more than eight rooms per dwelling tend to have low crime rates, low pupil-teacher ratios, and high median home values. These tracts appear to represent wealthier residential areas with more favorable living conditions.


Crime is higher in poorer, industrial, high-tax areas

Home values increase with number of rooms

A small number of tracts show extreme behavior (outliers)

Boston neighborhoods vary widely in socioeconomic conditions










































